@view-transition {
  navigation: auto;
}



nav {
  view-transition-name: nav-container;
}


::view-transition {
  /* Mirror variables */
  --transition-duration: 784ms;
}

::view-transition-group(*) {
  animation-timing-function: var(--transition-timing-motion);

}

/* Navigation layering via classes */
::view-transition-group(.nav-active) {
  animation-timing-function: var(--transition-timing-motion);

  z-index: 1;
}



::view-transition-group(.nav-foreground) {
  animation-timing-function: var(--transition-timing-style);
  z-index: 2;
}

/* (Theme switch shared elements removed; root-only theme transition retained) */

main {
  view-transition-name: page;
  /* Label for styling */
  view-transition-class: page;
  contain: layout style paint;
  /* Compositing hints */
  will-change: opacity, transform;
}





/* Theme toggle */
html.theme-transition {
  /* Temporary root name */
  view-transition-name: theme;
}

/* During theme toggle, suppress all other named elements so only a
   single shared element (the root "theme") is created. */
html.theme-transition * {
  view-transition-name: none !important;
}

/* While theme view-transition runs, suppress regular CSS transitions on
   nav items so they don't appear to animate at a different rate than
   the single root snapshot animation. */
html.theme-transition .nav-item,
html.theme-transition .nav-item .icon,
html.theme-transition .nav-item .title {
  transition: none !important;
}

/* Prevent the default root cross-fade from also animating during
   the theme toggle to avoid duplicate visuals. */
:root.theme-transition::view-transition-old(root),
:root.theme-transition::view-transition-new(root) {

  animation: none !important;
}

::view-transition-group(theme) {
  animation-duration: var(--transition-duration);

  animation-timing-function: var(--transition-timing-style);
  z-index: 0;
  /* page/root underlays switch parts */
}

::view-transition-old(theme) {
  animation-name: page-theme-old;

}

::view-transition-new(theme) {
  animation-name: page-theme-new;
  mix-blend-mode: saturation;
}

@keyframes page-theme-old {

  from {
    filter: blur(0px);
    opacity: 1;
  }

  to {
    filter: blur(0px);
    opacity: 0;
  }
}

@keyframes page-theme-new {
  from {
    filter: blur(0px);
    opacity: 0;
  }


  to {
    filter: blur(0px);
    opacity: 1;
  }


}

/* Shared animation settings for the page transition pair */
::view-transition-group(.page) {
  --vt-visible: 1;
  --vt-hidden: 0;
  --vt-blur: 2px;
  --vt-scale-min: 0.9;
  /* two animations run in parallel */
  animation-duration: var(--transition-duration);
  animation-timing-function: var(--transition-timing-style), var(--transition-timing-motion);
  height: 100%;

  transform-origin: top;
  animation-fill-mode: both, both;
}

/* Old → exiting */
::view-transition-old(.page) {
  animation-name: page-exit-opacity-blur, page-exit-scale;


}

/* New → entering */
::view-transition-new(.page) {
  animation-name: page-enter-opacity-blur, page-enter-scale;
  will-change: transform, opacity;
}


::view-transition-group(.nav-active) {
  will-change: transform, opacity, width, height;
}

/* Preserve snapshot alignment */
::view-transition-old(.card),
::view-transition-new(.card) {
  height: 100%;
  border-radius: 8px;

}










::view-transition-group(*) {
  animation-duration: var(--transition-duration);
  animation-timing-function: var(--transition-timing-motion);
  isolation: isolate;

}

/* Thumbnail aspect-ratio */
::view-transition-group(.thumbnail) {
  overflow: clip;
}

::view-transition-old(.thumbnail),
::view-transition-new(.thumbnail) {
  object-fit: cover;
  object-position: center;
  width: 100%;
  height: 100%;
}









@keyframes page-exit-opacity-blur {
  from {
    opacity: var(--vt-visible, 1);
    filter: blur(0px);
  }

  30% {
    opacity: var(--vt-hidden, 0);
    filter: blur(var(--vt-blur, 4px));
  }

  100% {
    opacity: var(--vt-hidden, 0);
    filter: blur(var(--vt-blur, 4px));
  }
}

@keyframes page-exit-scale {
  from {
    transform: scale(1);
  }

  30% {
    transform: scale(var(--vt-scale-min, 0.99));
  }

  to {
    transform: scale(var(--vt-scale-min, 0.99));
  }
}

@keyframes page-enter-opacity-blur {

  0% {
    opacity: 0;
    filter: blur(var(--vt-blur, 4px));
  }

  20% {
    opacity: var(--vt-hidden, 0);
    filter: blur(var(--vt-blur, 4px));
  }

  50% {
    opacity: var(--vt-visible, 1);
    filter: blur(0px);
  }


  to {
    opacity: var(--vt-visible, 1);
    filter: blur(0px);
  }
}

@keyframes page-enter-scale {
  0% {
    transform: scale(var(--vt-scale-min, 0.99));
  }

  20% {
    transform: scale(var(--vt-scale-min, 0.99));
  }

  50% {
    transform: scale(1);
  }

  to {
    transform: scale(1);
  }
}

/* Mobile override removed */


@media (prefers-reduced-motion: reduce) {

  /* Reduced motion: disable */
  @view-transition {
    navigation: none;
  }

  ::view-transition-old(),
  ::view-transition-new() {
    animation: none !important;
  }
}

/* BFCache restore: disable root anim */
html.restoring ::view-transition-old(root),
html.restoring ::view-transition-new(root) {
  animation: none !important;
}



/* Shared elements */
::view-transition-group(.heading) {
  overflow: visible;
}

::view-transition-group(.thumbnail) {
  overflow: clip;
}

::view-transition-old(.heading),
::view-transition-old(.thumbnail),
::view-transition-old(.badge-group) {
  animation: card-header-out var(--transition-duration) var(--transition-timing-motion);
}

::view-transition-new(.heading),
::view-transition-new(.thumbnail),
::view-transition-new(.badge-group) {
  animation: card-header-in var(--transition-duration) var(--transition-timing-motion);
}


/* Card→Header keyframes */
@keyframes card-header-out {
  from {
    opacity: 1;
    filter: blur(0px);
  }

  40% {
    opacity: 0;
    filter: blur(8px);
  }

  to {
    opacity: 0;
    filter: blur(8px);
  }
}

@keyframes card-header-in {
  from {
    opacity: 0;
    filter: blur(8px);
  }

  60% {
    opacity: 1;
    ;
  }

  to {
    opacity: 1;
    filter: blur(0px);
  }
}